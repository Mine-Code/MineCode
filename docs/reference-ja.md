# MineCode レファレンス
## MineCodeについて
MineCodeは主にPowerPCアーキテクチャの機械語を作成するためのツールです。

## 型の概念
MineCodeには型の概念がなく、すべて整数型として処理されます。
floatなどの少数型は現時点では、サポートしていません(今度のアップデートで対応する可能性)。
文字列型はその文字列へのポインタ（整数）になって格納されます。

## mcl
MineCodeでは色々な情報をJSONで記述できるmclというシステムがあります。
mclの例はこのリポジトリのmclsディレクトリにあるのでそこを参考にしてください。
構造は以下のとおりです。
```jsonc
{
  "name": "そのmclの名前",
  "ver": 1, // 現時点では1を指定してください
  // ストリームのような機能を提供できます
  "put": {
    "label": {
      "type": "asm",  // アセンブラであることを示します
                      // "asm" の他に "MineCode"も使用できます。
      "proc": "$arg:" // $arg には渡されたものが入ります
    },
    // 木構造で書くこともできます
    "a": {
      "b": {
        "type": "asm",
        "proc": "hello:" // $argが使われてなくてもエラーにはなりませんが推奨しません
      }
    }
  },
  // ポインタの宣言
  // 上から順に処理されるので、依存関係順に書いてください
  "pointers": [
    ["ポインタの名前", "ポインタ式"],
    // 例
    ["manager", "[0x20000000]"]
  ],
  // 関数の宣言
  "functions": { // これもまた木構造でもかけます
    "exit": {
      "addr": 33554432, // json の制約上10進数で書く必要があります
      "args": [ // 現時点では無視されます
        {
          // 引数の型です
          // 使える識別子は
          // int, cstr, wstr, ptr
          // cstrとwstrはstd::stringとstd::wstringの違いと同じです
          "T": "int",
          // デフォルトで渡される値の式です
          "default": "0"
        }
      ]
    }
  }
}
```

## 変数
MineCodeは変数をサポートしています。
この変数は型が無いため（すべて整数）型チェックができないという欠点があります。

### 特徴
MineCodeの型はC系の言語と違い、自動的に変数が宣言されます。
なので以下のようなソースがエラーなく動作します。
```
a = 1
b = a + 1
```  

## 関数
MineCodeでは型の概念がないため関数の定義が非常に簡単です。
ユーザー関数はまだまだ未熟ですが例を以下に示します
```
// int とか 実引数名は現時点では見ていません
func hoge(int a, int b){
}
```
アドレス指定関数呼び出しは他の言語より簡単に呼べます。  
※型チェックが行われないためクラッシュする可能性があります。
例を以下に示します
```
func[0x02000000](0) // 0x02000000にある関数を呼べる
```

## フロー制御
### For (特定の範囲だけのループ)
MineCodeには範囲を指定してループできる構文が有ります。
それを以下に示します。
```
for i in 0...10{

}
```

### If / While
多言語と同じなので略。